# Microfrontends with React: A Complete Developer's Guide

> ì‘ì„±ì¼: 2024-06-12  
> ì‘ì„±ì: dusunax  
> ìë£Œ: https://www.udemy.com/course/microfrontend-course/learn/lecture/23206822  

---

> 1~19: ë ˆí¬ì§€í† ë¦¬ Integrationì˜ ê¸°ì´ˆ (webpack)

### Webpack

- remote/webpack.config.js
  - í¬íŠ¸ëŠ” 8081

```tsx
const HtmlWebpackPlugin = require("html-webpack-plugin"); // íŒŒì¼ì— ìŠ¤í¬ë¦½íŠ¸ ì£¼ì…í•  ê²ƒ
const ModuleFederationPlugin = require("webpack/lib/container/ModuleFederationPlugin");

module.exports = {
  mode: "development",
  devServer: {
    port: 8081,
  },
  plugins: [
    new ModuleFederationPlugin({
      name: "products", // remoteë¥¼ ë§Œë“¤ë•Œë§Œ í•„ìš”í•˜ë‹¤. ì™¸ë¶€ì—ì„œ ì•Œì•„ë³´ê¸° ìœ„í•¨
      filename: "remoteEntry.js", // remoteEntry.jsë¥¼ í…œí”Œë¦¿ì— ì£¼ì… (htmlì˜ headì— <script defer src="remoteEntry.js"></script>)
      exposes: {
        "./ProductsIndex": "./src/index", // exposeí•  íŒŒì¼ ë§µ => containerì˜ bootstrap.jsì—ì„œ ì‚¬ìš©í•  ê²ƒ
        // ./src/indexê°€ ì•„ë‹ˆë¼ ë³„ì¹­ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ? í•„ìš”ì—†ê¸° ë•Œë¬¸ (ì–´ì°¨í”¼ index.js)
      },
    }),
    new HtmlWebpackPlugin({
      template: "./public/index.html", // main.jsë¥¼ í…œí”Œë¦¿ì— ì£¼ì… (htmlì˜ headì— <script defer src="main.js"></script>)
    }),
  ],
};
```

- container/webpack.config.js
  - í¬íŠ¸ëŠ” 8080

```tsx
const HtmlWebpackPlugin = require("html-webpack-plugin");
const ModuleFederationPlugin = require("webpack/lib/container/ModuleFederationPlugin");

module.exports = {
  mode: "development",
  devServer: {
    port: 8080,
  },
  plugins: [
    new ModuleFederationPlugin({
      name: "container",
      remotes: {
        products: "products@http://localhost:8081/remoteEntry.js",
        // ë°”ê¿”ë³´ê¸°
        // ğŸ‘‰ í‚¤ë‘ bootstrapì—ì„œ importí•˜ëŠ” ê²½ë¡œê°€ ì¼ì¹˜ì•¼í•¨ (ê²½ë¡œ ë³„ì¹­ ìƒê°í•˜ë©´ ë¨)
        // ì´ë ‡ê²Œë„ ë¨ "@products": "~~",
        // containerì˜ bootstrapì˜ import: "@products/ProductsIndex"

        // ğŸ‘‰ ê°’ì˜ @ì•ì˜ êµ¬ë¶„ìëŠ” remote ì´ë¦„ê³¼ ê°™ì•„ì•¼í•¨
        // ì´ë ‡ê²Œë„ ë¨ "~~": "hello_products@http://localhost:8081/remoteEntry.js",
        // remoteì˜ webpack.config.jsì˜ name: hello_products
      },
    }),
    new HtmlWebpackPlugin({
      template: "./public/index.html",
    }),
  ],
};
```

- container/src/bootstrap.js
  - containerì˜ index.jsì—ì„œ ë°”ë¡œ import ì•ˆí•˜ëŠ” ì´ìœ ?
  - contianerì˜ index.jsë¥¼ ì‹¤í–‰í•˜ê¸° ì „ productsì˜ ë””íœë˜ì‹œë¥¼ ì¤€ë¹„ ìˆ˜ ìˆë„ë¡ í•¨

```tsx
import "products/ProductsIndex"; // webpackì´ node modulesì—ì„œ ë””íœë˜ì‹œë¥¼ ëª» ì°¾ìœ¼ë©´ => ModuleFederationPluginì—ì„œ products í‚¤ë¥¼ ì°¾ì„ ê²ƒ

console.log("Container!");
```

- container/src/index.js

```tsx
import("./bootstrap"); // bootstrapì—ì„œ "products/ProductsIndex"ì„ import í•œ í›„, bootstrapì„ import
```

- products => main.js

![image](https://github.com/dusunax/javascript/assets/94776135/7f05e6a5-dd76-46ad-8397-76ff42d79308)

```mermaid
flowchart LR
    subgraph products
    index.js
    end
    index.js --> normal-bundling-process
    index.js --> module-federation-plugin
    subgraph webpack
    normal-bundling-process
    module-federation-plugin
    end
    normal-bundling-process --> main.js
    module-federation-plugin --> remoteEntry.js
```

```mermaid
flowchart LR
    subgraph container
    index.js
    id1["bootstrap.js"]
    end
    subgraph webpack
    id2["webpack"]
    end
    index.js --> id2
    id2 --> main.js
    id2 --> bootstrap.js
```
